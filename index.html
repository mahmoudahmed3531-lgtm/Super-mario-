<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ูู ุณูุฑุจุญ ุงูุชูุตููุงุชุ</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#03102a; --stage:#061c45; --ring:#0a2d6e; --line:#3ea3ff;
    --text:#e9f4ff; --ok:#20d07a; --bad:#ff3e4e; --warn:#ffc107;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:"Cairo",system-ui,sans-serif; color:var(--text);
    min-height:100vh; display:grid; place-items:center; overflow-x:hidden;
    background:
      radial-gradient(1200px 700px at 50% -200px,#1947b6 0%,transparent 60%),
      linear-gradient(#010814,#03102a 30%, #010814);
  }
  .wrap{width:min(1100px,96vw)}
  /* ====== ุดุฑูุท ุนููู (ูุณุงุฆู ุงููุณุงุนุฏุฉ + ุงูุนุฏุงุฏ) ====== */
  .top{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; margin-bottom:12px}
  .brand{font-weight:900; letter-spacing:.5px; font-size:clamp(20px,3vw,30px)}
  .brand span{color:#21d07a}
  .tools{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  .pill{
    background:linear-gradient(180deg,#113a86,#0b2663);
    border:2px solid var(--line); color:#cfe9ff; border-radius:999px; padding:8px 14px;
    font-weight:800; cursor:pointer; box-shadow:0 0 0 2px rgba(62,163,255,.2) inset, 0 8px 20px rgba(0,0,0,.25);
  }
  .pill:disabled{opacity:.45; filter:grayscale(1); cursor:not-allowed}
  .badge{background:rgba(255,255,255,.06); border:1px solid #285fb1; padding:8px 12px; border-radius:999px; font-weight:800}

  /* ====== ุงููุณุฑุญ ุงูุฏุงุฆุฑู ====== */
  .stage{
    position:relative; padding:22px 18px 26px; border-radius:26px; overflow:hidden;
    border:2px solid var(--line); background:var(--stage);
    box-shadow: 0 0 60px rgba(62,163,255,.22) inset, 0 0 120px rgba(62,163,255,.16);
  }
  /* ุฏูุงุฆุฑ ุงูู RPG */
  .stage::before,.stage::after{
    content:""; position:absolute; inset:-40% -10% auto -10%; height:140%;
    background:
      radial-gradient(closest-side,#2258bf 0%, transparent 55%) 50% 40%/60% 60% no-repeat,
      radial-gradient(closest-side,#14387f 0%, transparent 55%) 50% 40%/80% 80% no-repeat,
      radial-gradient(closest-side,rgba(62,163,255,.6) 0%, transparent 65%) 50% 40%/100% 100% no-repeat;
    opacity:.25; pointer-events:none; filter:blur(2px);
  }
  .timerBar{height:8px; border-radius:8px; margin-bottom:14px;
    background:linear-gradient(90deg,var(--ok),#27d4ff,var(--warn),var(--bad));
    transform-origin:left; box-shadow:0 0 14px rgba(62,163,255,.5)}
  .q{position:relative; margin:10px auto 12px; text-align:center; font-size:clamp(18px,2.3vw,24px);
    font-weight:900; padding:16px 14px; color:#fff;
    background:linear-gradient(180deg,#113a86 0%, #0b2663 100%);
    border:2px solid var(--line); border-radius:20px; box-shadow:0 14px 28px rgba(0,0,0,.35)}
  /* ====== ุงุฎุชูุงุฑุงุช โุฃุฌูุญุฉโ ูุซู ุงูุจุฑูุงูุฌ ====== */
  .grid{display:grid; grid-template-columns:1fr; gap:14px}
  @media (min-width:680px){ .grid{grid-template-columns:1fr 1fr} }
  .wing{
    --c:#1b49a7;
    position:relative; overflow:hidden; cursor:pointer; border:none; color:#e8f3ff;
    background:linear-gradient(180deg,#113a86,#0b2663);
    border:2px solid var(--line); padding:14px 20px; font-weight:900; font-size:clamp(15px,1.8vw,18px);
    border-radius:999px; text-align:center; box-shadow:0 0 0 2px rgba(62,163,255,.22) inset, 0 10px 24px rgba(0,0,0,.28);
  }
  .wing::before,.wing::after{
    content:""; position:absolute; top:0; bottom:0; width:20%; background:linear-gradient(180deg,#154189,#0e2f6b);
    border:inherit; transform:skewX(35deg); box-shadow:inherit
  }
  .wing::before{ right:100%; border-right:none; border-radius:20px 0 0 20px }
  .wing::after{ left:100%; border-left:none; border-radius:0 20px 20px 0 }
  .wing:disabled{opacity:.7; cursor:not-allowed}
  .correct{border-color:var(--ok)!important; background:linear-gradient(180deg,#0b6c4c,#0a3f2f)!important}
  .wrong{border-color:var(--bad)!important; background:linear-gradient(180deg,#7a0d0d,#430707)!important}

  /* ุณูู ุงูุฃุณุฆูุฉ */
  .ladder{margin-top:16px; display:grid; grid-template-columns:repeat(10,1fr); gap:6px}
  .step{border:1px solid #2e5fb6; border-radius:999px; padding:6px 0; font-size:12px; text-align:center; opacity:.6}
  .active{background:#1b49a7; color:#fff; opacity:1; border-color:#7fc4ff}
  .prize{color:#ffd66b; border-color:#ffd66b; font-weight:900; opacity:1}

  /* ููุฏุงู */
  .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(2,8,24,.65); backdrop-filter:blur(2px); z-index:20}
  .card{background:#0c1f4a; border:2px solid #5aa9ff; border-radius:18px; padding:22px; width:min(520px,92%); text-align:center; box-shadow:0 30px 80px rgba(0,0,0,.6)}
  .cta{background:linear-gradient(180deg,#1b77ff,#1256c7); color:#fff; font-weight:900; border:none; padding:10px 16px; border-radius:12px; cursor:pointer}
  .muted{opacity:.5}
</style>
</head>
<body>

<!-- ุฃุตูุงุช -->
<audio id="bgm" src="https://cdn.pixabay.com/audio/2023/10/03/audio_93c6b46b3e.mp3" loop></audio>
<audio id="clk" src="https://cdn.pixabay.com/audio/2022/03/15/audio_6e2b4e.mp3"></audio>
<audio id="ok"  src="https://cdn.pixabay.com/audio/2022/03/24/audio_5a7b66.mp3"></audio>
<audio id="bad" src="https://cdn.pixabay.com/audio/2022/03/15/audio_6b0a8a.mp3"></audio>

<div class="wrap">
  <div class="top">
    <div class="brand">ูู ุณูุฑุจุญ <span>ุงูุชูุตููุงุช</span>ุ</div>
    <div class="tools">
      <button id="fifty" class="pill">50:50</button>
      <button id="aud" class="pill">ุฑุฃู ุงูุฌูููุฑ</button>
      <button id="mute" class="pill">ูุชู/ุชุดุบูู</button>
      <div class="badge">ุงูุณุคุงู: <b id="qNo">1</b>/<b id="qTotal">70</b></div>
      <div class="badge">ุงูููุช: <b id="t">5</b>ุซ</div>
    </div>
  </div>

  <div class="stage">
    <div id="bar" class="timerBar"></div>
    <div id="q" class="q">โฆ</div>
    <div id="ans" class="grid"></div>
    <div id="ladder" class="ladder"></div>
  </div>
</div>

<div id="pop" class="modal">
  <div class="card">
    <div id="msg" style="font-weight:900; font-size:20px; margin-bottom:12px">ุฑุณุงูุฉ</div>
    <button id="again" class="cta">ุงุจุฏุฃ ูู ุฌุฏูุฏ</button>
  </div>
</div>

<script>
/* ================= ุฅุนุฏุงุฏุงุช ================= */
const WHATSAPP_PHONE = "201234567890"; // โ ุบููุฑ ุฑูู ูุงุชุณุงุจ (ุฏููู ุจุฏูู +)
const QUESTION_TIME  = 5; // ุซูุงูู
const FINAL_TARGET   = 70;

const Q = [
  {q:"ุฃูู ูู ุฃุณูู ูู ุงูุตุจูุงูุ",a:["ุนูู ุจู ุฃุจู ุทุงูุจ","ุฒูุฏ ุจู ุซุงุจุช","ุนุจุฏุงููู ุจู ูุณุนูุฏ","ุงูุญุณู"],c:0},
  {q:"ุนุงุตูุฉ ุงููุงุจุงูุ",a:["ุฃูุณุงูุง","ุทูููู","ูุงุบููุง","ูููุชู"],c:1},
  {q:"ุฃุทูู ุฃููุงุฑ ุงูุนุงููุ",a:["ุงูุฃูุงุฒูู","ุงูููู","ุงููุงูุบุชุณู","ุงููููุบู"],c:1},
  {q:"ุนุฏุฏ ุฃุฑูุงู ุงูุฅุณูุงูุ",a:["ุฎูุณุฉ","ุฃุฑุจุนุฉ","ุณุชุฉ","ุณุจุนุฉ"],c:0},
  {q:"ุณูุฑุฉ ุชูุณูู ููุจ ุงููุฑุขูุ",a:["ูุณ","ุงููุงุชุญุฉ","ุงูุฅุฎูุงุต","ุงูุฑุญูู"],c:0},
  {q:"ูุฎุชุฑุน ุงููุตุจุงุญ ุงูููุฑุจุงุฆูุ",a:["ุชุณูุง","ุฃุฏูุณูู","ูุงุฑุงุฏุงู","ููุฑุณ"],c:1},
  {q:"ุนุงุตูุฉ ุงููุบุฑุจุ",a:["ุงูุฏุงุฑ ุงูุจูุถุงุก","ุงูุฑุจุงุท","ูุงุณ","ูุฑุงูุด"],c:1},
  {q:"ุนุฏุฏ ุฃุญุฑู ุงูุนุฑุจูุฉุ",a:["28","29","27","26"],c:0},
  {q:"ุฃูู ูุณุฌุฏ ุจููู ุจุงูุฅุณูุงูุ",a:["ุงูุฃูุตู","ูุจุงุก","ุงููุจูู","ุงููููุฉ"],c:1},
  {q:"ุฃูุจุฑ ููุงูุจ ุงููุฌููุนุฉ ุงูุดูุณูุฉุ",a:["ุฒุญู","ุงููุดุชุฑู","ุฃูุฑุงููุณ","ูุจุชูู"],c:1},
  {q:"ุงูุตูุงุฉ ุงููุณุทู ููุ",a:["ุงููุฌุฑ","ุงูุธูุฑ","ุงูุนุตุฑ","ุงููุบุฑุจ"],c:2},
  {q:"ุนุงุตูุฉ ูุฑูุณุงุ",a:["ุจุฑููู","ูุฏุฑูุฏ","ุจุงุฑูุณ","ุฑููุง"],c:2},
  {q:"ูุบุฉ ุงูุจุฑุงุฒูู ุงูุฑุณููุฉุ",a:["ุงูุฅุณุจุงููุฉ","ุงูุจุฑุชุบุงููุฉ","ุงูุฅูุฌููุฒูุฉ","ุงููุฑูุณูุฉ"],c:1},
  {q:"ุณูุฉ ุงููุฌุฑุฉ ุชูุงููุ",a:["622ู","610ู","632ู","642ู"],c:0},
  {q:"ุฃูุจุฑ ูุญูุทุงุช ุงูุนุงููุ",a:["ุงูููุฏู","ุงูุฃุทูุณู","ุงููุงุฏู","ุงููุชุฌูุฏ"],c:2},
  {q:"ุฃูู ุฎูููุฉ ุนุจุงุณูุ",a:["ุงูููุตูุฑ","ุงูุณูุงุญ","ุงููุฃููู","ุงูููุฏู"],c:1},
  {q:"ูููุจ ุงูุดุฑูุ",a:["ููุฑูุฒ","ุฃู ููุซูู","ูุฑุฏุฉ","ูุฌุงุฉ"],c:1},
  {q:"ุงูุนุฑุจู ุงูุญุงุตู ุนูู ููุจู ุฃุฏุจุ",a:["ุงูุนูุงุฏ","ูุฌูุจ ูุญููุธ","ุงููููููุทู","ุงููุนุฑู"],c:1},
  {q:"ุงููุนุจุฉ ุชูุน ููุ",a:["ููุฉ","ุงููุฏููุฉ","ุงูุทุงุฆู","ุฌุฏุฉ"],c:0},
  {q:"ุบุงุฒ ุงูุชููุณ ุงูุฃุณุงุณูุ",a:["ุงูููุฏุฑูุฌูู","ุงูุฃูุณุฌูู","ุงูููุชุฑูุฌูู","ุงููููููู"],c:1},
  {q:"ุงููุงุฑุฉ ุงูุชู ุชุถู ูุตุฑุ",a:["ุขุณูุง","ุฃูุฑูููุง","ุฃูุฑูุจุง","ุฃูุฑููุง"],c:1},
  {q:"ุนุฏุฏ ุงูุณุฌุฏุงุช ูู ุงููุฑุขูุ",a:["14","15","13","16"],c:1},
  {q:"ุบุฒูุฉ ุจุฏุฑ ูู ุงูุณูุฉุ",a:["ุงูุฃููู ูููุฌุฑุฉ","ุงูุซุงููุฉ ูููุฌุฑุฉ","ุงูุซุงูุซุฉ","ุงูุฑุงุจุนุฉ"],c:1},
  {q:"ุนุงุตูุฉ ุงูุณูุฏุงูุ",a:["ุงูุฎุฑุทูู","ุฌูุจุง","ุจูุฑุชุณูุฏุงู","ูุณูุง"],c:0},
  {q:"ุฃู ุงููุคูููู ุงูุญูููุฑุงุกุ",a:["ุฎุฏูุฌุฉ","ุนุงุฆุดุฉ","ุณูุฏุฉ","ุญูุตุฉ"],c:1},
  {q:"ูุฎุชุฑุน ุงููุงุชูุ",a:["ุฃุฏูุณูู","ุฌุฑุงูุงู ุจูู","ูุงุฑูููู","ุชุณูุง"],c:1},
  {q:"ุฃูุฏู ุฌุงูุนุฉ ูุงุฆูุฉุ",a:["ูุงุฑูุงุฑุฏ","ุงููุฑูููู","ุงูุฃุฒูุฑ","ุจูููููุง"],c:1},
  {q:"ุนุงุตูุฉ ุฅุณุจุงููุงุ",a:["ูุฏุฑูุฏ","ุจุฑุดูููุฉ","ูุงููุณูุง","ูููุง"],c:0},
  {q:"ุฃูู ูู ุฌูุฑ ุจุงููุฑุขู ุจููุฉุ",a:["ุนูุฑ","ุฃุจู ุจูุฑ","ุงุจู ูุณุนูุฏ","ุจูุงู"],c:2},
  {q:"ุนุฏุฏ ุงูููุงูุจ ุงููุนุชุฑู ุจูุง ุญุงูููุงุ",a:["8","9","7","6"],c:0},
  {q:"ุตูู ุฑูุถุงู ููุฑุถ ููุ",a:["ุงูุฃููู ูููุฌุฑุฉ","ุงูุซุงููุฉ ูููุฌุฑุฉ","ุงูุซุงูุซุฉ","ุงูุนุงุดุฑุฉ"],c:1},
  {q:"ุงููููุจ ุงูุฃุญูุฑุ",a:["ุจููุชู","ุงููุฑูุฎ","ุนุทุงุฑุฏ","ุงูุฒููุฑุฉ"],c:1},
  {q:"ุฃุทูู ุณูุฑุฉุ",a:["ุขู ุนูุฑุงู","ุงูุจูุฑุฉ","ุงููุณุงุก","ุงูุฃุนุฑุงู"],c:1},
  {q:"ุณูู ุงูููุ",a:["ุญูุฒุฉ","ุฎุงูุฏ ุจู ุงููููุฏ","ุนูุฑ","ุนูู"],c:1},
  {q:"ุนุงุตูุฉ ุชุฑููุงุ",a:["ุฅุณุทูุจูู","ุฃููุฑุฉ","ุฅุฒููุฑ","ุจูุฑุตุฉ"],c:1},
  {q:"ุจุญุฑ ููุตู ุฃูุฑูุจุง ูุฃูุฑูููุงุ",a:["ุงูุนุฑุจู","ุงููุชูุณุท","ุงูุฃุณูุฏ","ุงูุฃุญูุฑ"],c:1},
  {q:"ูุคุฐู ุงูุฑุณููุ",a:["ุจูุงู","ุฃุจู ูุฑูุฑุฉ","ุฃุจู ููุณู","ุณููุงู"],c:0},
  {q:"ูุฏููุฉ ุงูุชูุงู ุงูุณุจุนุ",a:["ุฑููุง","ุฃุซููุง","ุจุงุฑูุณ","ุจุฑุงุบ"],c:0},
  {q:"ุงูุนููุฉ ุงูุฑุณููุฉ ููุตุฑุ",a:["ุงูุฌููู","ุงูุฑูุงู","ุงูุฏููุงุฑ","ุงูุฏููุงุฑ"],c:0},
  {q:"ุนุฑูุณ ุงููุฑุขูุ",a:["ุงูุฑุญูู","ููุณู","ุงูููู","ุงููุญู"],c:0},
  {q:"ุฑูุฒ ุงูุทุจ ุงูุชูููุฏูุ",a:["ุงููุฃุณ","ุงูุตูุฑ","ุงูุนุตุง ูุงูุซุนุจุงู","ุงูุดูุนุฏุงู"],c:2},
  {q:"ุฃุดูุฑ ุฌุจู ูู ููุฉุ",a:["ุงูุทูุฑ","ุนุฑูุฉ","ุฃุญุฏ","ุงูููุฑ"],c:3},
  {q:"ูุงุฆุฏ ุงููุฑูููุ",a:["ุนูุฑู ุจู ุงูุนุงุต","ุฎุงูุฏ ุจู ุงููููุฏ","ุณุนุฏ","ุงููุซูู"],c:1},
  {q:"ุงูุฃููุงุณ ูุชููู ููุ",a:["ุงูุญุฏูุฏ","ุงููุฑุจูู","ุงูุณููููู","ุงูุฐูุจ"],c:1},
  {q:"ุนุงุตูุฉ ูุจูุงูุ",a:["ุจูุฑูุช","ุทุฑุงุจูุณ","ุตูุฏุง","ุตูุนุงุก"],c:0},
  {q:"ุทู ุญุณูู ููุจูุ",a:["ุนููุฏ ุงูุฃุฏุจ ุงูุนุฑุจู","ุดูุฎ ุงูููุงุฏ","ุฃุจู ุงูุฑูุงูุฉ","ุฃููุฑ ุงูุดุนุฑุงุก"],c:0},
  {q:"ุฃูู ูู ุฎุทู ุจุงููููุ",a:["ุฅุฏุฑูุณ","ููุญ","ุขุฏู","ุฅุจุฑุงููู"],c:0},
  {q:"ูุฏููุฉ ุงูุฃููุงุฑุ",a:["ุจุงุฑูุณ","ููุฏู","ูุฏุฑูุฏ","ููููุง"],c:0},
  {q:"ูููุงุณ ุดุฏุฉ ุงูุฒูุงุฒูุ",a:["ุจุงุณูุงู","ุฑูุฎุชุฑ","ูููุชู","ูููุช"],c:1},
  {q:"ุนุฑูุณ ุงูุจุญุฑ ุงูููุณุทูููุฉุ",a:["ุนูุง","ูุงูุง","ุญููุง","ุบุฒุฉ"],c:1},
  {q:"ุฃูู ุงูุฎููุงุก ุงูุฑุงุดุฏููุ",a:["ุฃุจู ุจูุฑ","ุนูุฑ","ุนุซูุงู","ุนูู"],c:0},
  {q:"ููุฑ ุฏุฌูุฉ ููุฑ ููุ",a:["ุณูุฑูุง","ุงูุนุฑุงู","ูุตุฑ","ุงูุณูุฏุงู"],c:1},
  {q:"ุฃุตุบุฑ ุงููุงุฑุงุชุ",a:["ุฃุณุชุฑุงููุง","ุฃูุฑูุจุง","ุฃูุชุงุฑูุชููุง","ุขุณูุง"],c:0},
  {q:"ููุฌ ุงูุจุฑุฏุฉ ูููุ",a:["ุงูุจูุตูุฑู","ุงููุชูุจู","ุฃุญูุฏ ุดููู","ุนูุชุฑุฉ"],c:0},
  {q:"ุฃูุซุฑ ูุนุฏู ุจุงููุดุฑุฉุ",a:["ุงูุฃููููููู","ุงูุญุฏูุฏ","ุงููุญุงุณ","ุงูุฒูู"],c:0},
  {q:"ุนุฏุฏ ุณููุงุช ุงููุฑูุ",a:["50","100","75","200"],c:1},
  {q:"ุฃูู ูู ูููุจ ุจุฃููุฑ ุงููุคููููุ",a:["ุนูุฑ","ุนูู","ุนุซูุงู","ุฃุจู ุจูุฑ"],c:0},
  {q:"ุฃู ุงูุฏููุงุ",a:["ุงููุงูุฑุฉ","ุจุบุฏุงุฏ","ุฏูุดู","ุงูุฑุจุงุท"],c:0},
  {q:"ุณูุฑุฉ ุงููุชุงูุ",a:["ูุญูุฏ","ุงูุฃููุงู","ุงูุชูุจุฉ","ุงูุตู"],c:0},
  {q:"ููุงุชูุญ ุงูุจูุงูู ุงูููุงุณูุ",a:["66","72","88","96"],c:2},
  {q:"ููุชุดู ุงูุฌุงุฐุจูุฉุ",a:["ุขููุดุชุงูู","ูููุชู","ุบุงูููู","ูุจูุฑ"],c:1},
  {q:"ุนูุฑ ุงููุจู ุนูุฏ ุงูุจุนุซุฉุ",a:["25","30","40","45"],c:2},
  {q:"ุฌูุน (ูุชุงุจ)ุ",a:["ูุชุจ","ูุชุงุจูู","ูุชุงุจุงุช","ููุชุจุงุช"],c:0},
  {q:"ุนููุฉ ุงูุณุนูุฏูุฉุ",a:["ุงูุฏููุงุฑ","ุงูุฏุฑูู","ุงูุฑูุงู","ุงูุฌููู"],c:2},
  {q:"ุญุฑุจ ุฃูุชูุจุฑุ",a:["1973","1967","1956","1991"],c:0},
  {q:"ุฃูู ูู ุทุงู ุจุงููุนุจุฉุ",a:["ุฌุจุฑูู","ุฅุจุฑุงููู","ุขุฏู","ุฅุณูุงุนูู"],c:2},
  {q:"ุฃุนูู ููุฉ ูู ุงูุนุงููุ",a:["ููููููุฌุงุฑู","ุฅููุฑุณุช","ููู ุจูุงู","ุฃููููุงุฌูุง"],c:1},
  {q:"ุฃูู ูู ุจูู ุงูุณุฌูู ุจุงูุฅุณูุงูุ",a:["ุนูุฑ","ุนูู","ูุนุงููุฉ","ุนูุฑู"],c:0},
  {q:"ุณูุฑุฉ ุจูู ุฅุณุฑุงุฆููุ",a:["ุงูุฅุณุฑุงุก","ุงููุญู","ุงูุชูููุฑ","ุงูููุงูุฉ"],c:0},
  {q:"ุงูุนุงุตูุฉ ุงูุงูุชุตุงุฏูุฉ ูููุบุฑุจุ",a:["ุทูุฌุฉ","ุงูุฏุงุฑ ุงูุจูุถุงุก","ูุงุณ","ุงูุนููู"],c:1},
  {q:"ูููุงุณ ุดุฏุฉ ุงูุตูุชุ",a:["ุฏูุณูุจู","ูููุช","ุฃูู","ูุงุท"],c:0},
  {q:"ุฃูู ูู ุฑูู ุจุณูู ูู ุณุจูู ุงูููุ",a:["ุณุนุฏ ุจู ุฃุจู ููุงุต","ุทูุญุฉ","ุงูุฒุจูุฑ","ุญูุฒุฉ"],c:0},
];

const qEl=document.getElementById('q'), ansEl=document.getElementById('ans');
const qNo=document.getElementById('qNo'), qTot=document.getElementById('qTotal');
const bar=document.getElementById('bar'), tEl=document.getElementById('t');
const ladder=document.getElementById('ladder'), pop=document.getElementById('pop');
const msg=document.getElementById('msg'), again=document.getElementById('again');
const fifty=document.getElementById('fifty'), aud=document.getElementById('aud'), mute=document.getElementById('mute');
const bgm=document.getElementById('bgm'), clk=document.getElementById('clk'), ok=document.getElementById('ok'), bad=document.getElementById('bad');

qTot.textContent=FINAL_TARGET;

let idx=0, correctAt=0, timer=null, run=false, usedFifty=false, usedAud=false, muted=false;

function play(a){ if(!muted){ try{a.currentTime=0; a.play()}catch(e){} } }
function waSend(txt){ const url=`https://wa.me/${WHATSAPP_PHONE}?text=${encodeURIComponent(txt)}`; window.open(url,'_blank'); }

function makeLadder(){
  ladder.innerHTML="";
  for(let i=1;i<=FINAL_TARGET;i++){
    const d=document.createElement('div');
    d.className='step'+((i===30||i===50||i===70)?' prize':'');
    d.textContent=i; ladder.appendChild(d);
  }
}
function mark(){ [...ladder.children].forEach((c,i)=>c.classList.toggle('active',i===idx)); }

function stop(){ if(timer){ clearInterval(timer); timer=null; } }
function startTimer(){
  stop();
  const start=Date.now();
  tEl.textContent=QUESTION_TIME;
  bar.style.transform='scaleX(1)';
  timer=setInterval(()=>{
    const r=Math.max(0,QUESTION_TIME-Math.floor((Date.now()-start)/1000));
    tEl.textContent=r; bar.style.transform=`scaleX(${r/QUESTION_TIME})`;
    if(r<=0){ stop(); fail(); }
  },200);
}

function render(){
  run=true;
  qNo.textContent=idx+1;
  qEl.textContent=Q[idx].q;

  // ุชุฑุชูุจ ุนุดูุงุฆู ููุงุฎุชูุงุฑุงุช
  const order=[0,1,2,3]; for(let i=3;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [order[i],order[j]]=[order[j],order[i]];}
  correctAt = order.indexOf(Q[idx].c);

  ansEl.innerHTML="";
  order.forEach((pos,i)=>{
    const b=document.createElement('button');
    b.className='wing'; b.textContent=Q[idx].a[pos];
    b.onclick=()=>choose(i); ansEl.appendChild(b);
  });

  mark(); startTimer();
}

function choose(i){
  if(!run) return;
  play(clk); run=false; stop();
  const btns=[...ansEl.children];
  if(i===correctAt){
    btns[i].classList.add('correct'); play(ok);
    setTimeout(()=>{
      const n=idx+1;
      if(n===30){ popMsg("๐ ูุจุฑูู! ูุณุจุช <b>ุชูุตููุฉ ูุฌุงููุฉ</b> โ"); waSend("๐ ูุตูุช ููุณุคุงู 30 โ ูุณุจุช ุชูุตููุฉ ูุฌุงููุฉ ูู Fly Express."); return; }
      if(n===50){ popMsg("๐ ูุจุฑูู! ูุณุจุช <b>ุชูุตููุชูู ูุฌุงููุง</b> โ"); waSend("๐ ูุตูุช ููุณุคุงู 50 โ ูุณุจุช ุชูุตููุชูู ูุฌุงููุง ูู Fly Express."); return; }
      if(n===70){ popMsg("๐ ุฃูููุช ุงููุนุจุฉ โ ูุณุจุช <b>3 ุชูุตููุงุช ูุฌุงููุฉ</b> ๐"); waSend("๐ ุฃูููุช ุฌููุน ุงูุฃุณุฆูุฉ (70) โ ูุณุจุช 3 ุชูุตููุงุช ูุฌุงููุฉ."); return; }
      idx++; render();
    },650);
  }else{
    btns[i].classList.add('wrong'); btns[correctAt].classList.add('correct'); play(bad);
    setTimeout(fail,900);
  }
}

function popMsg(t){ msg.innerHTML=t; pop.style.display='grid'; }
function fail(){ popMsg("โ ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ ุฃู ุงูุชูู ุงูููุช.<br>ุณุชุจุฏุฃ ูู <b>ุงูุณุคุงู 1</b>."); }

again.onclick=()=>{ pop.style.display='none'; idx=0; usedFifty=false; usedAud=false; fifty.disabled=false; aud.disabled=false; render(); };

fifty.onclick=()=>{
  if(usedFifty) return; usedFifty=true; fifty.disabled=true;
  const btns=[...ansEl.children]; let r=0;
  for(let i=0;i<btns.length;i++){ if(i!==correctAt && r<2){ btns[i].disabled=true; btns[i].style.opacity=.35; r++; } }
};
aud.onclick=()=>{
  if(usedAud) return; usedAud=true; aud.disabled=true;
  const bars=[0,0,0,0]; let total=100, main=60+Math.floor(Math.random()*21);
  bars[correctAt]=main; total-=main;
  for(let i=0;i<4;i++){ if(i===correctAt) continue; const v=(i<3?Math.floor(Math.random()*(total-(3-i))):total); bars[i]=v; total-=v; }
  const overlay=document.createElement('div');
  overlay.className='modal'; overlay.style.display='grid';
  overlay.innerHTML=`<div class="card" style="width:min(520px,92%);">
    <div style="font-weight:900;margin-bottom:10px">๐ ุฑุฃู ุงูุฌูููุฑ</div>
    <div style="display:grid;gap:8px;text-align:start">
      ${bars.map((p,i)=>`<div><b>${String.fromCharCode(65+i)}:</b>
      <span style="display:inline-block;height:10px;background:#52a0ff;width:${p*2}px;border-radius:6px;margin:0 6px -1px 6px"></span>
      <b>${p}%</b></div>`).join("")}
    </div>
    <button class="cta" id="okpoll" style="margin-top:12px">ุญุณููุง</button>
  </div>`;
  document.body.appendChild(overlay);
  document.getElementById('okpoll').onclick=()=>overlay.remove();
};
mute.onclick=()=>{ muted=!muted; if(muted) bgm.pause(); else bgm.play().catch(()=>{}); mute.classList.toggle('muted',muted); };

// ุชููุฆุฉ ุฃูููุฉ
(function init(){
  // ุฎูุท ุงูุฃุณุฆูุฉุ ูุงูุชุตุงุฑูุง ุนูู 70 ููุท
  for(let i=Q.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [Q[i],Q[j]]=[Q[j],Q[i]];}
  while(Q.length>FINAL_TARGET) Q.pop();
  qTot.textContent=FINAL_TARGET;
  makeLadder(); render();
  bgm.volume=.5; bgm.play().catch(()=>{});
})();
</script>
</body>
</html>
